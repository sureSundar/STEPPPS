<?xml version="1.0" encoding="UTF-8"?>
<!-- TBOS Universal Detector - WiX Installer Configuration -->
<!-- ðŸ•‰ï¸ Swamiye Saranam Aiyappa ðŸ•‰ï¸ -->
<!--
  This creates a Windows MSI installer for TBOS Detector

  Build on Windows with WiX Toolset:
    candle tbos_detector.wxs
    light -ext WixUIExtension tbos_detector.wixobj

  Build on Linux with wixl (if available):
    wixl -o TBOS_Detector_Setup_v1.0.0.msi tbos_detector.wxs
-->

<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">

  <!-- Product Definition -->
  <Product
    Id="*"
    Name="TBOS Universal Detector"
    Language="1033"
    Version="1.0.0.0"
    Manufacturer="TBOS Project"
    UpgradeCode="A1B2C3D4-E5F6-7890-ABCD-EF1234567890">

    <!-- Package Information -->
    <Package
      InstallerVersion="200"
      Compressed="yes"
      InstallScope="perMachine"
      Description="TBOS Universal Hardware Detector v1.0.0"
      Comments="Universal hardware detection tool - Works on Windows, Linux, macOS" />

    <!-- Media Definition -->
    <Media Id="1" Cabinet="TBOSDetector.cab" EmbedCab="yes" />

    <!-- Upgrade Configuration -->
    <MajorUpgrade
      DowngradeErrorMessage="A newer version of TBOS Detector is already installed."
      AllowSameVersionUpgrades="yes" />

    <!-- Installation Directory Structure -->
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFiles64Folder">
        <Directory Id="TBOS" Name="TBOS">
          <Directory Id="INSTALLFOLDER" Name="Detector" />
        </Directory>
      </Directory>

      <!-- Start Menu -->
      <Directory Id="ProgramMenuFolder">
        <Directory Id="ApplicationProgramsFolder" Name="TBOS Detector" />
      </Directory>

      <!-- Desktop -->
      <Directory Id="DesktopFolder" Name="Desktop" />
    </Directory>

    <!-- Components -->
    <DirectoryRef Id="INSTALLFOLDER">
      <Component Id="MainExecutable64" Guid="B1C2D3E4-F5A6-7890-BCDE-FA1234567891" Win64="yes">
        <File
          Id="TBOSDetectorX64EXE"
          Source="build\windows\tbos_detector_x64.exe"
          KeyPath="yes"
          Checksum="yes" />

        <!-- Add to System PATH -->
        <Environment
          Id="PATH"
          Name="PATH"
          Value="[INSTALLFOLDER]"
          Permanent="no"
          Part="last"
          Action="set"
          System="yes" />
      </Component>

      <Component Id="MainExecutable32" Guid="C2D3E4F5-A6B7-8901-CDEF-AB1234567892" Win64="yes">
        <File
          Id="TBOSDetectorX86EXE"
          Source="build\windows\tbos_detector_x86.exe"
          KeyPath="yes"
          Checksum="yes" />
      </Component>

      <Component Id="Documentation" Guid="D3E4F5A6-B7C8-9012-DEFA-BC1234567893" Win64="yes">
        <File
          Id="README"
          Source="dist\windows\README_WINDOWS.txt"
          KeyPath="yes" />
        <File
          Id="LICENSE"
          Source="LICENSE.txt" />
      </Component>

      <Component Id="BatchScripts" Guid="E4F5A6B7-C8D9-0123-EFAB-CD1234567894" Win64="yes">
        <File
          Id="RUNDETECTOR"
          Source="dist\windows\RUN_DETECTOR.bat"
          KeyPath="yes" />
        <File
          Id="GETJSON"
          Source="dist\windows\GET_JSON.bat" />
      </Component>
    </DirectoryRef>

    <!-- Start Menu Shortcuts -->
    <DirectoryRef Id="ApplicationProgramsFolder">
      <Component Id="ApplicationShortcuts" Guid="F5A6B7C8-D9E0-1234-FABC-DE1234567895" Win64="yes">
        <Shortcut
          Id="TBOSDetectorShortcut"
          Name="TBOS Detector"
          Description="Universal Hardware Detection Tool"
          Target="[INSTALLFOLDER]RUN_DETECTOR.bat"
          Icon="TBOSIcon"
          WorkingDirectory="INSTALLFOLDER" />

        <Shortcut
          Id="TBOSReadmeShortcut"
          Name="TBOS Detector README"
          Description="Documentation and Usage Guide"
          Target="[INSTALLFOLDER]README_WINDOWS.txt"
          WorkingDirectory="INSTALLFOLDER" />

        <Shortcut
          Id="TBOSCmdShortcut"
          Name="TBOS Command Prompt"
          Description="Command prompt in TBOS directory"
          Target="[%ComSpec]"
          Arguments="/k cd /d &quot;[INSTALLFOLDER]&quot;"
          WorkingDirectory="INSTALLFOLDER" />

        <Shortcut
          Id="UninstallProduct"
          Name="Uninstall TBOS Detector"
          Description="Uninstalls TBOS Detector"
          Target="[SystemFolder]msiexec.exe"
          Arguments="/x [ProductCode]" />

        <RemoveFolder Id="ApplicationProgramsFolder" On="uninstall" />
        <RegistryValue
          Root="HKCU"
          Key="Software\TBOS\Detector"
          Name="installed"
          Type="integer"
          Value="1"
          KeyPath="yes" />
      </Component>
    </DirectoryRef>

    <!-- Desktop Shortcut -->
    <DirectoryRef Id="DesktopFolder">
      <Component Id="DesktopShortcut" Guid="A6B7C8D9-E0F1-2345-ABCD-EF1234567896" Win64="yes">
        <Shortcut
          Id="DesktopTBOSDetector"
          Name="TBOS Detector"
          Description="Universal Hardware Detection Tool"
          Target="[INSTALLFOLDER]RUN_DETECTOR.bat"
          Icon="TBOSIcon"
          WorkingDirectory="INSTALLFOLDER" />
        <RegistryValue
          Root="HKCU"
          Key="Software\TBOS\Detector"
          Name="desktop_shortcut"
          Type="integer"
          Value="1"
          KeyPath="yes" />
      </Component>
    </DirectoryRef>

    <!-- Icon -->
    <Icon Id="TBOSIcon" SourceFile="build\windows\tbos_detector_x64.exe" />

    <!-- Features -->
    <Feature Id="ProductFeature" Title="TBOS Detector" Level="1">
      <ComponentRef Id="MainExecutable64" />
      <ComponentRef Id="MainExecutable32" />
      <ComponentRef Id="Documentation" />
      <ComponentRef Id="BatchScripts" />
      <ComponentRef Id="ApplicationShortcuts" />
      <ComponentRef Id="DesktopShortcut" />
    </Feature>

    <!-- UI -->
    <UIRef Id="WixUI_InstallDir" />
    <UIRef Id="WixUI_ErrorProgressText" />

    <Property Id="WIXUI_INSTALLDIR" Value="INSTALLFOLDER" />

    <!-- Custom license RTF is optional, defaults to EULA -->
    <!-- <WixVariable Id="WixUILicenseRtf" Value="license.rtf" /> -->

    <!-- Branding -->
    <WixVariable Id="WixUIBannerBmp" Value="banner.bmp" Overridable="yes" />
    <WixVariable Id="WixUIDialogBmp" Value="dialog.bmp" Overridable="yes" />

  </Product>
</Wix>
