# TernaryBit OS - Universal Shell Makefile

CC = gcc
CFLAGS = -Wall -Wextra -g -I../../include -I../../core -I../common
LDFLAGS = -lm

# Source files
SHELL_SRCS = \
    tbos_universal_shell.c \
    commands_core.c \
    commands_week1.c \
    commands_week2.c \
    commands_week3.c \
    commands_week4.c \
    commands_week5.c \
    commands_week6.c \
    commands_week7.c \
    commands_week8.c \
    commands_week9.c \
    commands_week10.c \
    main_shell.c
SHELL_OBJS = $(SHELL_SRCS:.c=.o)

# Dependencies (stubs for now)
DEPS_SRCS = ../../core/stubs/tbos_ramdisk.c \
            ../../core/stubs/tbos_hal.c \
            ../../core/stubs/tbos_consciousness.c \
            ../../core/stubs/tbos_karma.c \
            ../../core/stubs/tbos_sangha.c \
            ../../core/stubs/tbos_boot_stub.c
DEPS_OBJS = $(DEPS_SRCS:.c=.o)

# Target
TARGET = tbos_shell

# Build rules
all: $(TARGET)

$(TARGET): $(SHELL_OBJS) $(DEPS_OBJS)
	@echo "๐จ Linking Universal Shell..."
	$(CC) $(CFLAGS) -o $@ $^ $(LDFLAGS)
	@echo "โ Shell built successfully: ./$(TARGET)"
	@echo ""
	@echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
	@echo "โ   TernaryBit OS Universal Shell - Ready!             โ"
	@echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ"
	@echo "โ   Run: ./$(TARGET)                                   โ"
	@echo "โ   Test: make test                                    โ"
	@echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
	@echo ""

%.o: %.c
	@echo "๐ Compiling $<..."
	$(CC) $(CFLAGS) -c $< -o $@

../../core/stubs/%.o: ../../core/stubs/%.c
	@echo "๐ Compiling stub $<..."
	@mkdir -p ../../core/stubs
	$(CC) $(CFLAGS) -c $< -o $@

test: $(TARGET)
	@echo ""
	@echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
	@echo "โ   Running Universal Shell                            โ"
	@echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
	@echo ""
	@echo "Type 'help' for commands, 'exit' to quit"
	@echo ""
	./$(TARGET)

clean:
	@echo "๐งน Cleaning..."
	rm -f $(SHELL_OBJS) $(DEPS_OBJS) $(TARGET)
	@echo "โ Clean complete"

.PHONY: all test clean
